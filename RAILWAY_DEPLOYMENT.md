# ğŸš‚ Railway Deployment Guide

Complete step-by-step guide to deploy the Full Body Workout Tracker to Railway.

## ğŸ“‹ Prerequisites

- GitHub account
- Railway account (sign up at [railway.app](https://railway.app))
- Your code pushed to GitHub

---

## ğŸš€ Deployment Steps

### Step 1: Push Your Code to GitHub

Make sure all your latest changes are committed and pushed:

```bash
git add .
git commit -m "Prepare for Railway deployment"
git push origin main
```

### Step 2: Create Railway Account

1. Go to [railway.app](https://railway.app)
2. Click "Login" â†’ "Login with GitHub"
3. Authorize Railway to access your repositories

### Step 3: Create New Project

1. Click "New Project" on Railway dashboard
2. Select "Deploy from GitHub repo"
3. Choose your repository: `fullbodyworkout`
4. Railway will start detecting your app automatically

### Step 4: Add PostgreSQL Database

1. In your Railway project, click "+ New"
2. Select "Database" â†’ "Add PostgreSQL"
3. Railway will create a PostgreSQL database
4. The `DATABASE_URL` environment variable is automatically created

### Step 5: Configure Environment Variables

Railway should auto-detect most variables, but verify these are set:

1. Click on your web service
2. Go to "Variables" tab
3. Ensure these variables exist:

```
DATABASE_URL (auto-generated by Railway PostgreSQL)
PORT (optional, Railway auto-assigns)
NODE_ENV=production
```

### Step 6: Run Database Migration

After the first deployment:

1. Click on your web service
2. Go to "Settings" â†’ Scroll to "Deploy"
3. Under "Custom Start Command", temporarily change to:
   ```
   npm run db:push && npm run start
   ```
4. Redeploy the service
5. After successful migration, you can remove `npm run db:push` from the start command

**Alternative:** Use Railway CLI to run migrations (see below)

### Step 7: Deploy

1. Railway automatically deploys on git push
2. Check "Deployments" tab to monitor progress
3. Wait for build to complete (2-5 minutes)
4. Once deployed, you'll see a green checkmark âœ…

### Step 8: Get Your Public URL

1. In your web service, go to "Settings"
2. Scroll to "Networking" â†’ "Public Networking"
3. Click "Generate Domain"
4. Railway will give you a URL like: `your-app.up.railway.app`
5. Click the URL to open your app!

---

## ğŸ”§ Advanced Configuration

### Using Railway CLI (Optional)

Install Railway CLI for easier management:

```bash
# Install Railway CLI
npm install -g @railway/cli

# Login
railway login

# Link to your project
railway link

# Run migrations manually
railway run npm run db:push

# View logs
railway logs

# Open your app
railway open
```

### Custom Domain Setup

1. Go to your web service â†’ "Settings"
2. Scroll to "Networking" â†’ "Custom Domain"
3. Add your domain (e.g., `workout.yourdomain.com`)
4. Add the CNAME record to your DNS provider:
   ```
   CNAME: your-custom-domain â†’ your-app.up.railway.app
   ```

### Environment-Specific Settings

For different environments, you can create multiple services:

- `production` - Main app
- `staging` - Testing environment

Each can have different environment variables.

---

## ğŸ“Š Monitoring & Maintenance

### View Logs

1. Click on your web service
2. Go to "Deployments" tab
3. Click on a deployment to see logs
4. Or use CLI: `railway logs`

### Monitor Usage

1. Go to project "Settings"
2. Check "Usage" tab
3. Monitor:
   - Execution time
   - Memory usage
   - Network egress
   - Estimated cost

### Free Tier Limits

Railway provides **$5 free credit per month**:

- Typically covers ~500 execution hours
- ~100 GB bandwidth
- Shared CPU, 512MB RAM
- Services sleep after 30 min inactivity on hobby plan

**To prevent sleeping:** Upgrade to Pro plan ($5/month base)

---

## ğŸ› Troubleshooting

### Build Fails

**Check build logs:**
1. Go to "Deployments"
2. Click failed deployment
3. Check logs for errors

**Common issues:**
- Missing dependencies: Ensure `package.json` is complete
- Build command fails: Check `railway.json` build command
- Out of memory: Increase memory in service settings

### Database Connection Error

**Verify DATABASE_URL:**
1. Go to "Variables" tab
2. Ensure `DATABASE_URL` exists
3. Format: `postgresql://user:password@host:port/database`

**Run migrations:**
```bash
railway run npm run db:push
```

### App Not Loading

**Check:**
1. Deployment status (should be "Active")
2. Logs for errors
3. PORT variable (Railway sets automatically)
4. Start command: `npm run start`

### 500 Internal Server Error

**Debug steps:**
1. Check logs: `railway logs`
2. Verify all environment variables are set
3. Ensure database is running
4. Check migrations ran successfully

---

## ğŸ”„ Continuous Deployment

Railway automatically redeploys when you push to GitHub:

```bash
# Make changes
git add .
git commit -m "Update feature"
git push origin main

# Railway automatically detects and redeploys
```

### Disable Auto-Deploy

1. Go to service "Settings"
2. Scroll to "Service" section
3. Find "Auto Deploy" â†’ Toggle off

---

## ğŸ’° Cost Optimization Tips

1. **Use free tier wisely:**
   - Monitor usage regularly
   - Delete unused services

2. **Optimize build:**
   - Use build cache
   - Remove unused dependencies

3. **Database optimization:**
   - Use connection pooling
   - Index frequently queried fields
   - Clean up old data

4. **For production:**
   - Upgrade to Pro plan ($5/month)
   - Prevents sleeping
   - Better performance

---

## ğŸ“š Useful Commands

```bash
# Check service status
railway status

# Open app in browser
railway open

# View environment variables
railway variables

# Run one-time command
railway run <command>

# SSH into container
railway shell
```

---

## âœ… Post-Deployment Checklist

- [ ] App is accessible via Railway URL
- [ ] Database migrations completed
- [ ] All features working correctly
- [ ] Custom domain configured (if needed)
- [ ] Environment variables verified
- [ ] Logs show no errors
- [ ] Usage monitoring set up
- [ ] Backup strategy in place

---

## ğŸ‰ Success!

Your Full Body Workout Tracker is now live on Railway!

**Next steps:**
- Test all features thoroughly
- Set up custom domain (optional)
- Monitor usage and costs
- Share your app!

**Need help?**
- Railway Docs: [docs.railway.app](https://docs.railway.app)
- Railway Discord: [discord.gg/railway](https://discord.gg/railway)

---

## ğŸ“ Quick Reference

| Task | Command/Location |
|------|------------------|
| Deploy | `git push origin main` |
| View logs | Railway Dashboard â†’ Deployments |
| Run migrations | `railway run npm run db:push` |
| Environment vars | Dashboard â†’ Variables tab |
| Custom domain | Settings â†’ Networking |
| View usage | Settings â†’ Usage |
| Get public URL | Settings â†’ Networking â†’ Generate Domain |
